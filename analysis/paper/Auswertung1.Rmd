---
title: "NFDI4Objects Umfrageauswertung"
author:
  - Sophie C. Schmidt:
      email: sophie.schmidt@dainst.org
      institute: [DAI]
      correspondence: true
institute:
  - DAI: Deutsches Archäologisches Institut
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  md_document:
    variant: markdown_github
always_allow_html: true

---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- With the following code you can access and display values from the yml header above. -->

Keywords: `r rmarkdown::metadata$keywords`

Highlights: `r rmarkdown::metadata$highlights`

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)
```

# Datengrundlage

Daten als csv bekommen und IPs etc entfernt. Insgesamt über 600 Antworten, dabei aber viele, die sich "nur durchgeklickt" haben oder nur Teile der Umfrage ausgefüllt haben (teilweise um die 70%).

```{r}
d <- read.csv2("../data/raw_data/results-survey615517.csv", sep = ",", encoding = "UTF-8")

# remove "" as input and make NA out of it
# dplyr solution fom here: https://stackoverflow.com/questions/24172111/change-the-blank-cells-to-na

library(dplyr)

empty_as_na <- function(x){
    if("factor" %in% class(x)) x <- as.character(x) ## since ifelse wont work with factors
    ifelse(as.character(x)!="", x, NA)
}

## transform all columns
d <- d %>% 
  mutate_each(funs(empty_as_na))

```


```{r rename column names}
d_fr <- d[, c(1:65)]

#colnames(d)

colnames(d_fr) <- c("ID", "Datum", "zufallsid", "geschlecht", "alter", "blickwinkel", "einrichtung", "einrichtung_sonstiges", "disz", "studiernede", "promovierende", "lehrende", "techn_mitarb", "wiss_mitarb", "daten_it_beauftragt", "projektleiter", "einrichtung_leiter", "gruppe_sonstige", "arbeitgeber_richtlinienkatalog", "erfahrung_fdm", "stellenwert_fdm", "software_projman_janein", "software_projman", "software_fdm_janein", "software_fdm", "software_wiss_analyse", "xls", "doc", "pdf", "ods", "csv", "odt", "png", "jpg", "geotiff", "geojson", "shp", "json", "xml", "dateiformat-sonstige", "software_fd_analyse", "externes_datenzentrum", "privatwirtsch_cloud", "versionierung", "nicht-oeff_cloud", "zentralnetz_arbeitgeber", "institut-repo_arbeigeber", "repo_fachcomm", "lokal_dienstrechner", "lokal_privatrechner", "ext_festplatte", "usb", "cds-dvds", "datensicherung-sonstiges", "sicherung-nach-projekt", "FAIR_bekannt_janein", "verfuegung_wie", "verfuegung_wie-sonstiges", "fremddatennutzung-janein", "fremddaten_online-portal", "fremddaten_prsnl-anfrage", "wunsch_datenspeicherung", "fremddaten-sonsstiges", "mehrwert-n4o", "prsnl-mehrwert-n4o")

```



# Demographische Angaben

## Alter und Beschäftigungsverhältnis

Zuerst einige allgemeine Statistiken zu der Teilnehmergruppe:

```{r}
age_erfahrung <- d[,c(5:21)]

library(ggplot2)

ggplot()+
  geom_bar(data = age_erfahrung, aes(x = Wie.alt.sind.Sie., 
                                     fill = In.welcher.Art.von.Einrichtung.sind.Sie.beruflich.tätig.,
                                     na.rm = TRUE))+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 45, hjust=0.8),
        axis.title.x = element_blank()) +
  ylab("Anzahl")+
  scale_fill_discrete(name = "Arbeitsplatz")
```
Wir haben knapp 50 20-29jährige, der Großteil der befragten ist zwischen 30 udn 60 Jahre alt und arbeitet an einer Hochschule, in der Forschung, im Museum oder in einer Denkmalbehörde (man beachte die über 80jährige Person, die nicht mehr arbeitet...). Seltener kommen Grabungsfirmen und Archive vor. 

## Alter und Gruppe

Innerhalb der Altersstufen teilen sich die Menschen auf folgende Gruppen auf:

```{r}

# 1. Daten umstrukturieren (breits Format von Spalte 6-14 in langes Format umwandeln. NAs raus und "nein" raus.)
# df4 <- df3 %>% gather(key = "placenr", value = "example", "A", "B","C","D", na.rm = TRUE)

library(tidyr)

age_group <- age_erfahrung %>%
  gather(key = "gruppe", value = "ja.nein", 6:14, na.rm = TRUE) %>%
  filter(ja.nein == "Ja" )

ggplot()+
  geom_bar(data = age_group, 
           aes(x = In.welcher.Art.von.Einrichtung.sind.Sie.beruflich.tätig.,
               fill = gruppe,
               na.rm = TRUE))+
  theme_bw()+
  xlab("")+
  ylab("Anzahl (Mehrfachnennungen möglich)")+
  coord_flip()+
  scale_fill_discrete(name="Gruppe",
                         labels=c("Daten/IT-Beauftragte", "Lehrende", "Leiter/in der Einrichtung", "Projektleiter/in", "Promovierende", "Studierende", "technische Mitarbeiter/innen", "wissenschaftliche Mitarbeiter/innen"))+
  theme(legend.position = "bottom", 
        legend.key.size = unit(0.25, "cm"),
        legend.text = element_text(size = 6))
  

```
Das Gros besteht aus wissenschaftlichen Mitarbeiterinnen an der Hochschule und in Forschungseinrichtungen.

# Alter und Erfahrung + Wichtung

Gibt es einen Zusammenhang zwischen dem Alter der Teilnehmenden Person, der Erfahrung die sie in digitalen Forschungsdatenmanagement hat  und dem Gewicht, dass sie dem sie ihm zuweist?

```{r}
library(viridis)
ggplot(data = age_group, 
           aes_string(x = names(age_group)[1],
               y = names(age_group)[7],
               na.rm = TRUE))+
  geom_boxplot()+
  geom_jitter(position=position_jitter(width=.3, height=0), aes_string(colour = names(age_group)[8]))+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 45, hjust=0.8),
        axis.title.x = element_blank(),
        title = element_text("Selbsteinschätzung: Erfahrung mit digitalem Forschungsdatenmanagement")) +
  ylab("0: keine Erfahrung, 10: viel Erfahrung") + 
  xlab ("Alter")+
  scale_color_viridis(option = "D")+
  scale_colour_viridis(name = " Einschätzung des Stellenwertes \n von FDM für tägliche Arbeit ")

```
Alle Altersgruppen haben sehr gemischt Erfahrungen und Wissensstände mit digitalem Datenmanagement. Bei den Senioren (70-79) lassen sich zwei Gruppen differenzieren (viel Ahnung - wenig Ahnung), sie halten digitales Forschungsdatenmanagement allgemein für weniger wichtig für ihre tägliche Arbeit.

Jüngere Teilnehmende schätzen ihre eigene Erfahrung deutlich geringer ein als diejenigen "die im Beruf stehen" und zwischen 30 und 60 Jahre alt sind. Diese Gruppe scheint dem digitalen FDM auch den höchsten Stellenwert in ihrer täglichen Arbeit zuzuweisen.

Wer viel von Forschungsdatenmanagement hält, scheint sich häufig schon recht gut weitergebildet zu haben (oder anders herum: Einschätzung der Wichtigkeit kommt von eigener Erfahrung!). Nur wenige Personen geben an, ihre Erfahrung als mittig einzuschätzen, wenn sie FDM für wichtig halten und die gelben Punkte (sehr hoher Stellenwert des digitalen FDM für die eigene Arbeit) häufen sich im Bereich "viel Erfahrung). 

Diese Ergebnisse sollten statistische getestet werden:

### Test: Alter - Erfahrung mit spearmans rho

Für den Test werden die Teilnehmer entfernt, die keine Altersangabe gemacht haben.
```{r}
age_group <- subset(age_group, age_group[1] != "keine Angabe")

colnames(age_group) <- c("alter", "blickwinkel", "einrichtung", "einricht_sonst", "disz", "fdm_strategie_arbeitgeb", "erfahrung_digfdm", "stellenwert_digfdm", "gruppe", "ja.nein")

```
Es bleiben für den Vergleich `r nrow(age_group)` Teilnehmer.

```{r}
age_group2 <- age_group %>%
  separate(alter, c("beginn", "ende"), sep = "-") 

age_group2$beginn <- as.numeric(age_group2$beginn)

cor.test(age_group2$beginn, age_group2$erfahrung_digfdm,  method = "spearman")

```
Nach der Berechnung des Tests lässt sich keine signifikante Korrelation zwischen Alter und Erfahrung feststellen, somit besteht kein linearer Zusammenhang zwischen Alter und Erfahrung mit digitalem FDM. Dies überrascht nicht, da die älteren Kolleg*innen vmtl weniger Kontakt bisher damit hatten.

Aus diesem Grund wird die Vermutung eines linearen Zusammenhangs aufgegeben und nur ein Vergleich der verschiedenen Gruppen (kategorial) geführt:

### Test: Alter - Erfahrung mit chi²

Der Chi-Quadrat-Test darf eigentlich für diese Daten nicht angewendet werden, da die Erwartungswerte zu gering werden (Anzahl der Teilnehmer muss auf zu viele Subgruppen aufgeteilt werden). Anhang der Residuen lassen sich trotzdem Erkenntnisse erarbeiten:
```{r}
chi <- chisq.test(age_group[,1], age_group[,7])

chi$residuals
```
die größten Abweichungen gibt es bei der Altersgruppe der 20-29jährigen im Bereich "Erfahrung = 0", dort sind sie überrepräsentiert, ebenso wie die Altersgruppen 60-69 und 70-70 im Bereich der niedrigen Erfahrungswerte 1-3 überrepräsentiert sind.


```{r}
library(lsr)

cramersV(age_group[,1], age_group[,7])
```
Cramers V ergibt einen Wert von 0,16, was auf einen schwachen Zusammenhang zwischen Altersgruppe und Erfahrung schließen lässt.

--> Conclusio: Ältere und junge haben wenig Erfahrung. Das ist nicht allzu überraschend.

Als nächstes kann die Gewichtung für die eigene Arbeit untersucht werden: 

### Test: Alter - Wichtung mit spearmans rho

```{r}
cor.test(rank(age_group[,1]), age_group[,8],  method = "spearman")

```
Je älter, desto weniger wichtig. Schwacher, aber höchstsignifikanter Zusammenhang.

### Test: Alter - Wichtung mit Chi²

Wie oben kann auch hier nur mit den Residualwerten gearbeitet werden. 
```{r}
chi <- chisq.test(age_group[,1], age_group[,8])

chi$residuals
```
Auffällig ist hier die Altersgruppe der 20-29jährigen, die dem digitalen FDM eine höhere Bedeutung zuweist als erwartet. Ältere Semester tun das wenig überraschender weise gegenteilig. 

```{r}
cramersV(age_group[,1], age_group[,8])
```
Anhand Cramers V ~ 0,16 lässt sich wieder ein schwacher Zusammenhang zwischen Alter und Gewichtung festhalten.


## Korreliert die Einschätzung der Wichtigkeit und die Erfahrung und lassen sich darin Gruppen unterscheiden?

Für diese Frage werden die beiden Werte Einschätzung der Wichtigkeit für das eigene Arbeiten und die eigene Erfahrung gegeneinander plotten. Da in beiden Fällen keine stetigen metrischen Werte vorliegen, sondern nur mit diskreten Werten gearbeitet wurde, muss für die Visualisierung ein "jitter-Effekt" eingesetzt werden, der die Punkte ein wenig verschiebt, damit nicht alle direkt übereinander liegen.  

Allgemein kann der Zusammenhang bestätigt werden (eingezeichnet blaue Linie ist lineare Regression mit Konfidenzintervall). Verschiedene Einfärbungen werden nun getestet:

### Gruppenzugehörigkeit

```{r}

erfahrung_group <- age_erfahrung %>%
  gather(key = "gruppe", value = "ja.nein", 6:14, na.rm = TRUE) %>%
  filter(ja.nein == "Ja" ) 

library(stringr)
erfahrung_group$gruppe <- str_replace_all(erfahrung_group$gruppe,"Zu.welchen.Gruppen.fühlen.Sie.sich.zugehörig...","")


cbp1 <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
          "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

ggplot()+
  geom_jitter(data = erfahrung_group, aes_string(x = names(erfahrung_group)[7],
                                   y = names(erfahrung_group)[8],
                                   col = names(erfahrung_group)[9]))+
  ylab("Einschätzung Bedeutung FDM")+
  xlab("Einschätzung eigene Erfahrung FDM")+
  theme_bw() +
  scale_x_continuous(breaks=c(0,2,4,6,8,10),
                   labels = c(0,2,4,6,8,10))+
  scale_y_continuous(breaks=c(0,2,4,6,8,10),
                   labels = c(0,2,4,6,8,10))+
  scale_colour_manual(name="Gruppe",
                        values = c(cbp1, "grey80"),
                      breaks = c("Daten.und..oder.IT.Beauftragte.", "Lehrende.","Leiter.in.der.Einrichtung.", "Projektleiter.in.", "Promovierende.", "Studierende.", "technische.Mitarbeiter.innen.","wissenschaftliche.Mitarbeiter.innen."),
                      labels=c("Daten/IT-Beauftragte", "Lehrende", "Leiter/in der Einrichtung", "Projektleiter/in", "Promovierende", "Studierende", "technische Mitarbeiter/innen", "wissenschaftliche Mitarbeiter/innen")) +
  geom_text(aes(x = 5, y = 0, label = "gestreute Daten um Überlappungen zu vermeiden!"))+
  geom_segment(aes(x = -1, y = 6, xend = 4, yend = 6), colour="grey", linetype = "dashed", alpha = 0.5)+
  geom_segment(aes(x = 4, y = 6, xend = 4, yend = 11), colour="grey", linetype = "dashed", alpha = 0.5)+
  geom_smooth(data = erfahrung_group, aes_string(x = names(erfahrung_group)[7],
                                   y = names(erfahrung_group)[8]),
              method = "glm",
              formula = y~x) + # y abhängig von x 
   scale_alpha_continuous(guide=FALSE)+
  scale_linetype_discrete(guide = FALSE)
```
m. E. lässt sich kein Zusammenhang zwischen der Zugehörigkeit zu einer Gruppe und der Wichtung / Erfahrung im digitalen FDM finden.

Auffällig ist der/die einsame Studierende oben links in der Ecke, der/die die Bedeutung von FDM sehr hoch einschätzt, aber selber überhaupt keine Erfahrung hat. Kann dieser Person jemand bitte ganz schnell einen Datenbankenkurs anbieten? 

Der Bereich "hat selber wenig Erfahrung, schätzt aber die Bedeutung für die eigene Arbeit hoch ein" (also Einschätzung Bedeutung FDM 6-10 und Einschätzung eigene Erfahrung FDM 0-4) ist eine Zielgruppe für uns: Das sind die Personen, die wissen, dass sie sich fortbilden müssen, denen aber evtl einfach das Angebot fehlt. Es sind darin alle Gruppen vertreten, außer Daten- und IT-Beautragte.

### Blickwinkel der Antwortenden

```{r}

ggplot()+
  geom_jitter(data = erfahrung_group, aes_string(x = names(erfahrung_group)[7],
                                   y = names(erfahrung_group)[8],
                                   col = names(erfahrung_group)[2]))+
  ylab("Einschätzung Bedeutung FDM")+
  xlab("Einschätzung eigene Erfahrung FDM")+
  theme_bw() +
  scale_x_continuous(breaks=c(2,4,6,8,10),
                   labels = c(2,4,6,8,10))+
  scale_y_continuous(breaks=c(2,4,6,8,10),
                   labels = c(2,4,6,8,10))+
  scale_colour_discrete(name="Blickwinkel")+
  geom_text(aes(x = 5, y = 0, label = "gestreute Daten um Überlappungen zu vermeiden!"))+
  geom_smooth(data = erfahrung_group, aes_string(x = names(erfahrung_group)[7],
                                   y = names(erfahrung_group)[8]),
              method = "glm",
              formula = y~x) # y abhängig von x 
```
Institutionen und Individuen zeigen keine Musterungen.

### Einrichtungen
```{r}
cbp1 <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
          "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot()+
  geom_jitter(data = erfahrung_group, aes_string(x = names(erfahrung_group)[7],
                                   y = names(erfahrung_group)[8],
                                   col = names(erfahrung_group)[3]))+
  ylab("Einschätzung Bedeutung FDM")+
  xlab("Einschätzung eigene Erfahrung FDM")+
  theme_bw() +
  scale_x_continuous(breaks=c(2,4,6,8,10),
                   labels = c(2,4,6,8,10))+
  scale_y_continuous(breaks=c(2,4,6,8,10),
                   labels = c(2,4,6,8,10))+
  scale_colour_manual(name="Einrichtung",
                        values = c(cbp1, "black"))+
  geom_text(aes(x = 5, y = 0, label = "gestreute Daten um Überlappungen zu vermeiden!"))+
  geom_smooth(data = erfahrung_group, aes_string(x = names(erfahrung_group)[7],
                                   y = names(erfahrung_group)[8]),
              method = "glm",
              formula = y~x) # y abhängig von x 
```
Eventuell zeigen sich Grabungsfirmen insbesondere in dem höherschätzenden Bereich. Es zeigt sich bei allen Einrichtungen eine große Heterogenität.


### Teststatistiken zu dem Zusammenhang eigenes Wissen und Bedeutung

```{r}
colnames(erfahrung_group) <- c("alter", "blickwinkel", "einrichtung", "einricht_sonst", "disz", "fdm_strategie_arbeitgeb", "erfahrung_digfdm", "stellenwert_digfdm", "gruppe", "ja.nein")

fit <- lm(erfahrung_digfdm ~ stellenwert_digfdm, data = erfahrung_group)

summary(fit)

```
R² ~ 0,34: moderater Zusammenhang zwischen eigener Erfahrung und dem Stellenwert der dem digitalen FDM zugeschrieben wird.


### Gibt es eine Trennung zwischen Menschen mit viel und wenig Ahnung?

Hier ist es sinnvoll, sich einfach die Verteilung anzuschauen. Ist sie normalverteilt?
```{r}
ggplot()+
  geom_bar(data = age_erfahrung, 
           aes_string(x = names(age_erfahrung[16])))+
  theme_bw()+
  scale_x_continuous(breaks=c(0:10),
                   labels = c(0:10))+
  xlab("Erfahrung im Umgang mit digitalem FDM, 0: keine, 10: viel.")
 

getmode <- function(v) { # die Funktion heißt getmode und wird auf einen Vektor v angewendet
   uniqv <- unique(v) # die einzelnen Werte des Vektors (ohne Dopplungen) werden in einem Vektor uniqv gesammelt 
   uniqv[which.max(tabulate(match(v, uniqv)))] # welcher maximale Wert entsteht, wenn ich zähle, wie häufig die Werte von uniqv in v vorkommen (das ist der Modus)
}

erfahrung <- age_erfahrung[,16]

erfahrung <- erfahrung[!is.na(erfahrung)]
  
```

Die Erfahrung mit digitalem Datenmanagement in unserer Umfrage ist nicht-normalverteilt, sondern nach rechts verschoben:

 - Median = `r median(age_erfahrung[,16], na.rm=TRUE)`
 - Mittelwert = `r mean(age_erfahrung[,16], na.rm=TRUE)`
 - Modus =  `r getmode(erfahrung)`

Hier kann sich zeigen, dass wir vor allem Leute erreicht haben, die sich mit dem Thema schon beschäftigt haben. Es gibt einen deutlichen Anstieg zwischen der Einschätzung "4" und "5". Hier lassen sich eventuell zwei Gruppen unterscheiden.

# Welche Arbeitgeber haben ein Richtlinienkatalog?

```{r}

library(kableExtra)

dt <- table(d$In.welcher.Art.von.Einrichtung.sind.Sie.beruflich.tätig., d$Verfügt.Ihr.Arbeitgeber...Ihre.Einrichtung.über.einen.Richtlinienkatalog...eine.Strategie.zum.Umgang.mit.Forschungsdaten.)

dt %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```

Für die Analyse, ob es hier nennenswerte Unterschiede gibt, entfernen wir die Angaben "weiß nicht":

```{r}

d1 <- d%>%
  filter(Verfügt.Ihr.Arbeitgeber...Ihre.Einrichtung.über.einen.Richtlinienkatalog...eine.Strategie.zum.Umgang.mit.Forschungsdaten. != "weiß nicht")

chi <- chisq.test(table(d1$In.welcher.Art.von.Einrichtung.sind.Sie.beruflich.tätig., d1$Verfügt.Ihr.Arbeitgeber...Ihre.Einrichtung.über.einen.Richtlinienkatalog...eine.Strategie.zum.Umgang.mit.Forschungsdaten.))

chi$residuals

```
Chi nur eingeschränkt nutzbar, weil die Voraussetzungen nicht 100% erfüllt. Grabungsfirmen und außeruniversitäre Forschungseinrichrungen haben häufiger einen Richtlinienkatalog als zu erwarten währen, während insbesondere Museen keine haben.


# Acknowledgements

<!-- The following line inserts a page break  -->

\newpage

# References 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
